<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<dogrules:ruleList xsi:schemaLocation="http://elite.polito.it/domotics/dog/rules/rule_definition rule_definition.xsd " xmlns:dogrules="http://elite.polito.it/domotics/dog/rules/rule_definition" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <dogrules:rule name="buttonToPlug">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification fromDevice="Switch_allPlugsLiving" class="OnNotification" name="on"/>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state ofDevice="MainsPowerOutlet_p23_living" class="OnOffState" name="off"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command toDevice="MainsPowerOutlet_p23_living" class="OnOffFunctionality" name="on"/>
            </dogrules:action>
            <dogrules:action>
                <dogrules:command toDevice="MainsPowerOutlet_p23_living" class="OnOffFunctionality" name="off"/>
                <dogrules:instant time="18:05:30"/>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
    <dogrules:rule name="rule1">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification fromDevice="Shutter1" class="StateChangeNotification" name="stateChanged">
                    <dogrules:param type="ShutterState" value="lowering" name="newState"/>
                </dogrules:notification>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state ofDevice="Lamp1" class="OnOffState" name="off"/>
            </dogrules:when>
            <dogrules:when>
                <dogrules:state evaluator="&lt;" value="50.0" ofDevice="Lamp2" class="LightIntensityState"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification fromDevice="Shutter2" class="StateChangeNotification" name="stateChanged">
                    <dogrules:param value="lowering" name="newState"/>
                </dogrules:notification>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state ofDevice="Lamp1" class="OnOffState" name="off"/>
            </dogrules:when>
            <dogrules:when>
                <dogrules:state evaluator="&lt;" value="50.0" ofDevice="Lamp2" class="LightIntensityState"/>
            </dogrules:when>
        </dogrules:or-if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command toDevice="Lamp1" class="OnOffFunctionality" name="on"/>
                <dogrules:command toDevice="Lamp3" class="LightRegulationFunctionality" name="set">
                    <dogrules:param value="50" name="value"/>
                </dogrules:command>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
    <dogrules:rule name="timedOnOven">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification fromDevice="Button1" class="PressedNotification" name="pressed"/>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state ofDevice="Plug2" class="OnOffState" name="off"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification fromDevice="DogScheduler" class="TimedTriggerNotification" name="c31b6dbe-b431-4c86-b4f7-6595a98319f4">
                    <dogrules:param value="c31b6dbe-b431-4c86-b4f7-6595a98319f4" name="triggerId"/>
                </dogrules:notification>
            </dogrules:event>
        </dogrules:or-if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification fromDevice="DogScheduler" class="TimedTriggerNotification" name="ace9dc83-998a-47c5-84b2-38053f7b12f7">
                    <dogrules:param value="ace9dc83-998a-47c5-84b2-38053f7b12f7" name="triggerId"/>
                </dogrules:notification>
            </dogrules:event>
        </dogrules:or-if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification fromDevice="DogScheduler" class="TimedTriggerNotification" name="8b137f89-27c1-4170-8aa3-0bfb4e12ad7c">
                    <dogrules:param value="8b137f89-27c1-4170-8aa3-0bfb4e12ad7c" name="triggerId"/>
                </dogrules:notification>
            </dogrules:event>
        </dogrules:or-if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command toDevice="kitchenOven" class="OnOffFunctionality" name="on"/>
                <dogrules:interval duration="PT45M"/>
            </dogrules:action>
            <dogrules:action>
                <dogrules:command toDevice="kitchenOven" class="TemperatureRegulationFunctionality" name="set">
                    <dogrules:param value="230" name="value"/>
                </dogrules:command>
            </dogrules:action>
            <dogrules:action>
                <dogrules:command toDevice="SimpleLamp_lamp3_storage" class="OnOffFunctionality" name="on"/>
                <dogrules:instant time="20:00:00"/>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
</dogrules:ruleList>
